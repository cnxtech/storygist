!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Navigo",[],e):"object"==typeof exports?exports.Navigo=e():t.Navigo=e()}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e){"use strict";function i(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function n(){return!("undefined"==typeof window||!window.history||!window.history.pushState)}function o(t,e,i){this.root=null,this._routes=[],this._useHash=e,this._hash=void 0===i?"#":i,this._paused=!1,this._destroyed=!1,this._lastRouteResolved=null,this._notFoundHandler=null,this._defaultHandler=null,this._usePushState=!e&&n(),this._onLocationChange=this._onLocationChange.bind(this),this._genericHooks=null,t?this.root=e?t.replace(/\/$/,"/"+this._hash):t.replace(/\/$/,""):e&&(this.root=this._cLoc().split(this._hash)[0].replace(/\/$/,"/"+this._hash)),this._listen(),this.updatePageLinks()}function a(t){return t instanceof RegExp?t:t.replace(/\/+$/,"").replace(/^\/+/,"^/")}function s(t,e){return 0===e.length?null:t?t.slice(1,t.length).reduce(function(t,i,n){return null===t&&(t={}),t[e[n]]=decodeURIComponent(i),t},null):null}function r(t){var e,i=[];return e=t instanceof RegExp?t:new RegExp(t.replace(o.PARAMETER_REGEXP,function(t,e,n){return i.push(n),o.REPLACE_VARIABLE_REGEXP}).replace(o.WILDCARD_REGEXP,o.REPLACE_WILDCARD)+o.FOLLOWED_BY_SLASH_REGEXP,o.MATCH_REGEXP_FLAGS),{regexp:e,paramNames:i}}function l(t){return t.replace(/\/$/,"").split("/").length}function c(t,e){return l(e)-l(t)}function d(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map(function(e){var i=r(a(e.route)),n=i.regexp,o=i.paramNames,l=t.replace(/^\/+/,"/").match(n),c=s(l,o);return!!l&&{match:l,route:e,params:c}}).filter(function(t){return t})}function u(t,e){return d(t,e)[0]||!1}function h(t,e){var i=e.map(function(e){return""===e.route||"*"===e.route?t:t.split(new RegExp(e.route+"($|/)"))[0]}),n=a(t);return i.length>1?i.reduce(function(t,e){return t.length>e.length&&(t=e),t},i[0]):1===i.length?i[0]:n}function g(){return!!("undefined"!=typeof window&&"onhashchange"in window)}function p(t){return t.split(/\?(.*)?$/).slice(1).join("")}function v(t,e,i){var o,a=t.split(/\?(.*)?$/)[0];return void 0===i&&(i="#"),n()&&!e?a=a.split(i)[0]:(o=a.split(i),a=o.length>1?a.split(i)[1]:o[0]),a}function f(t,e,i){return e&&"object"===(void 0===e?"undefined":w(e))?void(e.before?e.before(function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(t(),e.after&&e.after(i))},i):e.after&&(t(),e.after&&e.after(i))):void t()}function b(t,e,i){if(n()&&!e)return!1;if(!t.match(i))return!1;var o=t.split(i);return o.length<2||""===o[1]}Object.defineProperty(e,"__esModule",{value:!0});var w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};o.prototype={helpers:{match:u,root:h,clean:a},navigate:function(t,e){var i;return t=t||"",this._usePushState?(i=(e?"":this._getRoot()+"/")+t.replace(/^\/+/,"/"),i=i.replace(/([^:])(\/{2,})/g,"$1/"),history[this._paused?"replaceState":"pushState"]({},"",i),this.resolve()):"undefined"!=typeof window&&(t=t.replace(new RegExp("^"+this._hash),""),window.location.href=window.location.href.replace(/#$/,"").replace(new RegExp(this._hash+".*$"),"")+this._hash+t),this},on:function(){for(var t=this,e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];if("function"==typeof i[0])this._defaultHandler={handler:i[0],hooks:i[1]};else if(i.length>=2)if("/"===i[0]){var o=i[1];"object"===w(i[1])&&(o=i[1].uses),this._defaultHandler={handler:o,hooks:i[2]}}else this._add(i[0],i[1],i[2]);else if("object"===w(i[0])){var a=Object.keys(i[0]).sort(c);a.forEach(function(e){t.on(e,i[0][e])})}return this},off:function(t){return null!==this._defaultHandler&&t===this._defaultHandler.handler?this._defaultHandler=null:null!==this._notFoundHandler&&t===this._notFoundHandler.handler&&(this._notFoundHandler=null),this._routes=this._routes.reduce(function(e,i){return i.handler!==t&&e.push(i),e},[]),this},notFound:function(t,e){return this._notFoundHandler={handler:t,hooks:e},this},resolve:function(t){var e,n,o=this,a=(t||this._cLoc()).replace(this._getRoot(),"");this._useHash&&(a=a.replace(new RegExp("^/"+this._hash),"/"));var s=p(t||this._cLoc()),r=v(a,this._useHash,this._hash);return!this._paused&&(this._lastRouteResolved&&r===this._lastRouteResolved.url&&s===this._lastRouteResolved.query?(this._lastRouteResolved.hooks&&this._lastRouteResolved.hooks.already&&this._lastRouteResolved.hooks.already(this._lastRouteResolved.params),!1):(n=u(r,this._routes))?(this._callLeave(),this._lastRouteResolved={url:r,query:s,hooks:n.route.hooks,params:n.params},e=n.route.handler,f(function(){f(function(){n.route.route instanceof RegExp?e.apply(void 0,i(n.match.slice(1,n.match.length))):e(n.params,s)},n.route.hooks,n.params,o._genericHooks)},this._genericHooks,n.params),n):this._defaultHandler&&(""===r||"/"===r||r===this._hash||b(r,this._useHash,this._hash))?(f(function(){f(function(){o._callLeave(),o._lastRouteResolved={url:r,query:s,hooks:o._defaultHandler.hooks},o._defaultHandler.handler(s)},o._defaultHandler.hooks)},this._genericHooks),!0):(this._notFoundHandler&&f(function(){f(function(){o._callLeave(),o._lastRouteResolved={url:r,query:s,hooks:o._notFoundHandler.hooks},o._notFoundHandler.handler(s)},o._notFoundHandler.hooks)},this._genericHooks),!1))},destroy:function(){this._routes=[],this._destroyed=!0,clearTimeout(this._listenningInterval),"undefined"!=typeof window&&(window.removeEventListener("popstate",this._onLocationChange),window.removeEventListener("hashchange",this._onLocationChange))},updatePageLinks:function(){var t=this;"undefined"!=typeof document&&this._findLinks().forEach(function(e){e.hasListenerAttached||(e.addEventListener("click",function(i){var n=t.getLinkPath(e);t._destroyed||(i.preventDefault(),t.navigate(n.replace(/\/+$/,"").replace(/^\/+/,"/")))}),e.hasListenerAttached=!0)})},generate:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this._routes.reduce(function(i,n){var o;if(n.name===t){i=n.route;for(o in e)i=i.toString().replace(":"+o,e[o])}return i},"");return this._useHash?this._hash+i:i},link:function(t){return this._getRoot()+t},pause:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._paused=t},resume:function(){this.pause(!1)},disableIfAPINotAvailable:function(){n()||this.destroy()},lastRouteResolved:function(){return this._lastRouteResolved},getLinkPath:function(t){return t.pathname||t.getAttribute("href")},hooks:function(t){this._genericHooks=t},_add:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"string"==typeof t&&(t=encodeURI(t)),"object"===(void 0===e?"undefined":w(e))?this._routes.push({route:t,handler:e.uses,name:e.as,hooks:i||e.hooks}):this._routes.push({route:t,handler:e,hooks:i}),this._add},_getRoot:function(){return null!==this.root?this.root:(this.root=h(this._cLoc().split("?")[0],this._routes),this.root)},_listen:function(){var t=this;if(this._usePushState)window.addEventListener("popstate",this._onLocationChange);else if(g())window.addEventListener("hashchange",this._onLocationChange);else{var e=this._cLoc(),i=void 0,n=void 0;(n=function(){i=t._cLoc(),e!==i&&(e=i,t.resolve()),t._listenningInterval=setTimeout(n,200)})()}},_cLoc:function(){return"undefined"!=typeof window?void 0!==window.__NAVIGO_WINDOW_LOCATION_MOCK__?window.__NAVIGO_WINDOW_LOCATION_MOCK__:a(window.location.href):""},_findLinks:function(){return[].slice.call(document.querySelectorAll("[data-navigo]"))},_onLocationChange:function(){this.resolve()},_callLeave:function(){this._lastRouteResolved&&this._lastRouteResolved.hooks&&this._lastRouteResolved.hooks.leave&&this._lastRouteResolved.hooks.leave()}},o.PARAMETER_REGEXP=/([:*])(\w+)/g,o.WILDCARD_REGEXP=/\*/g,o.REPLACE_VARIABLE_REGEXP="([^/]+)",o.REPLACE_WILDCARD="(?:.*)",o.FOLLOWED_BY_SLASH_REGEXP="(?:/$|$)",o.MATCH_REGEXP_FLAGS="",e.default=o,t.exports=e.default}])}),function(t){function e(e,i){var n=encodeURIComponent(window.location.href),o={beatSelector:"[data-sg]",contentParent:"main",initWidth:640,animate:!1,onboard:!0,callToAction:"View in full story ↓",pager:{html:'<div class="gist-pager"><button class="gist-pager__btn gist-pager__btn--prev" aria-label="previous"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="512px" height="512px" viewBox="0 0 512 512" xml:space="preserve"> <polygon points="352,115.4 331.3,96 160,256 331.3,416 352,396.7 201.5,256 "/> </svg></button> <button class="gist-pager__btn gist-pager__btn--next" aria-label="next"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 512 512" xml:space="preserve"> <polygon points="160,115.4 180.7,96 352,256 180.7,416 160,396.7 310.5,256 "/> </svg></button></div>'},finalBeat:{raw:null,html:'<div class="gist-beat-container">\x3c!--Entypo pictograms by Daniel Bruce — www.entypo.com--\x3e<div class="gist-beat-row"><h4>Share</h4><ul class="gist-share"><li><a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u='+n+'"><svg version="1.1" x="0" y="0" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve">\n<title>Facebook Logo</title>\n<desc>Share on Facebook</desc>\n<path d="M17 1H3C1.9 1 1 1.9 1 3v14c0 1.1 0.9 2 2 2h7v-7H8V9.53h2V7.48c0-2.16 1.21-3.68 3.77-3.68l1.8 0v2.61h-1.2C13.38 6.4 13 7.14 13 7.84v1.69h2.57L15 12h-2v7h4c1.1 0 2-0.9 2-2V3C19 1.9 18.1 1 17 1z"></path>\n</svg></a></li><li><a target="_blank" href="https://twitter.com/intent/tweet?url='+n+'"><svg version="1.1" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve">\n<title>Twitter Logo</title>\n <desc>Share on Twitter</desc>\n <path d="M17.316 6.246c0.008 0.2 0 0.3 0 0.488c0 4.99-3.797 10.742-10.74 10.742c-2.133 0-4.116-0.625-5.787-1.697 c0.296 0 0.6 0.1 0.9 0.053c1.77 0 3.397-0.604 4.688-1.615c-1.651-0.031-3.046-1.121-3.526-2.621 c0.23 0 0.5 0.1 0.7 0.066c0.345 0 0.679-0.045 0.995-0.131c-1.727-0.348-3.028-1.873-3.028-3.703c0-0.016 0-0.031 0-0.047 c0.509 0.3 1.1 0.5 1.7 0.473c-1.013-0.678-1.68-1.832-1.68-3.143c0-0.691 0.186-1.34 0.512-1.898 C3.942 5.5 6.7 7 9.9 7.158C9.798 6.9 9.8 6.6 9.8 6.297c0-2.084 1.689-3.773 3.774-3.773 c1.086 0 2.1 0.5 2.8 1.191c0.859-0.17 1.667-0.484 2.397-0.916c-0.282 0.881-0.881 1.621-1.66 2.1 c0.764-0.092 1.49-0.293 2.168-0.594C18.694 5.1 18.1 5.7 17.3 6.246z"></path>\n</svg></a></li><li><a target="_blank" href="mailto:?body='+n+'"><svg version="1.1" x="0" y="0" viewBox="0 0 20 20" xml:space="preserve">\n<title>Email Icon</title>\n<desc>Email page link</desc>\n<path d="M1.57 5.29c0.49 0.26 7.25 3.89 7.5 4.03C9.33 9.45 9.65 9.51 9.98 9.51c0.33 0 0.65-0.06 0.91-0.2s7.01-3.77 7.5-4.03C18.88 5.02 19.34 4 18.44 4H1.52C0.62 4 1.09 5.02 1.57 5.29zM18.61 7.49c-0.56 0.29-7.39 3.85-7.73 4.03s-0.58 0.2-0.91 0.2 -0.57-0.02-0.91-0.2S1.94 7.78 1.39 7.49C1 7.28 1 7.52 1 7.71S1 15 1 15c0 0.42 0.57 1 1 1h16c0.43 0 1-0.58 1-1 0 0 0-7.11 0-7.29S19 7.29 18.61 7.49z"></path>\n</svg></a></li></ul></div><div class="gist-beat-row"><h4 class="go-to-beginning">Go to the beginning</h4><ul></li><a class="go-to-beginning" href="#"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve">\n<path d="M0.685,10h2.372V9.795c0.108-4.434,3.724-7.996,8.169-7.996c4.515,0,8.174,3.672,8.174,8.201s-3.659,8.199-8.174,8.199\n\tc-1.898,0-3.645-0.65-5.033-1.738l1.406-1.504c1.016,0.748,2.27,1.193,3.627,1.193c3.386,0,6.131-2.754,6.131-6.15\n\tc0-3.396-2.745-6.15-6.131-6.15c-3.317,0-6.018,2.643-6.125,5.945V10h2.672l-3.494,3.894L0.685,10z"/>\n</svg></li></ul></div></div>',type:"DIV"}};this.element=e,this.$els={},this.settings=t.extend({},o,i)}window.StoryGist=e}(jQuery),function(t,e){e.Static={},e.Static.currentBeatIndex=0,e.Static.getCurrentBeat=function(){return t("#gist-beat-"+e.Static.getCurrentBeatNum())},e.Static.getCurrentBeatNum=function(){if(t(".gist-beat:visible").length){var e=t(".gist-beat:visible").get(0);return t(e).data("origid")}return 0},e.Static.getRandTransition=function(){return e.Static.TRANSITIONS[Math.floor(Math.random()*e.Static.TRANSITIONS.length)]},e.Static.dependencyChecker=function(t){t.forEach(function(t){var e=window,i=t;0===t.indexOf("$.")&&(e=window.$,i=t.replace("$.","")),"function"==typeof e[i]||"object"==typeof e[i]?console.log("### window."+t," detected"):console.warn("### window."+t," Not Found")})},e.Static.getBeatFromTarget=function(e){var i=t(e);return i.hasClass("gist-beat")||(i=i.closest(".gist-beat"),i.hasClass("gist-beat"))?i:null},e.Static.TRANSITIONS=["transition.slideLeftIn","transition.slideDownIn","transition.slideLeftBigIn","transition.shrinkIn","transition.flipXIn","transition.flipYIn","transition.fadeIn","transition.expandIn"]}(jQuery,StoryGist),function(t,e,i){i.Navigation={},i.Navigation.router=new e("",!0),i.Navigation.navigateToBeat=function(t,e){var n=e||i.Navigation.totalBeats;t>=0&&t<=n&&i.Navigation.router.navigate("/beat/"+t)},i.Navigation.updateGlobalActiveGist=function(e){var i=t(document.body);t(".gist-beat").each(function(n){i.hasClass("gist-beat-"+n+"-active")&&i.removeClass("gist-beat-"+n+"-active"),e===n&&i.addClass("gist-beat-"+n+"-active"),i.hasClass("gist-beat-last-active")&&i.removeClass("gist-beat-last-active"),t(".gist-beat.last").hasClass("active")&&i.addClass("gist-beat-last-active")})},i.Navigation.goToBeat=function(e){console.log("goToBeat:",e),t(".gist-beat").removeClass("active");var n=t("#gist-beat-"+e);n.addClass("active"),t(".gist-beat").hide(),n.show(),i.Navigation.updateGlobalActiveGist(+e),i.Navigation.updateProgressBar(+e),i.Navigation.updateCta(+e)},i.Navigation.updateProgressBar=function(e){for(var n=0;n<i.Navigation.totalBeats;n++)n>e?t("#gist-progress #gist-progress-beat-"+(n-1)).css("opacity",1):t("#gist-progress #gist-progress-beat-"+(n-1)).css("opacity",0);+e===i.Navigation.totalBeats?t("#gist-progress").hide():t("#gist-progress").show()},i.Navigation.handleKeys=function(t){if(t.key){var e=i.Static.getCurrentBeat(),n=e.data("origid");switch(t.key){case"ArrowLeft":this.prevBeat(n,e);break;case"ArrowRight":this.nextBeat(n,e);break;default:return}t.preventDefault()}},i.Navigation.updateCta=function(e){var n=i.Static.getCurrentBeat(),o=t(n).data("cta-text");o&&t("#gist-view-story").text(o)},i.prototype.initNavigation=function(){i.Navigation.totalBeats=this.totalBeats,i.Navigation.$element=t(this.element),i.Navigation.updateGlobalActiveGist(0),t(document).keydown(i.Navigation.handleKeys.bind(this)),i.Navigation.router.on("/beat/:beatNum",function(t){i.Navigation.goToBeat(t.beatNum)}).resolve()}}(jQuery,Navigo,StoryGist),function(t,e){e.Modal={};var i=t(".gist-modal-wrapper"),n=t(".gist-modal-close");e.Modal.createIframe=function(t,e){console.log("createIframe>>",t,e);var n='<iframe id="beat-modal-'+e+'" src="'+t+'" frameborder="0" width="100%" scrolling="yes" allowtransparency="true"></iframe>';i.append(n)},e.Modal.show=function(e){i.addClass("is-active"),t("#beat-modal-"+e).show().css({width:"100%",height:"100%"}),i.show()},e.Modal.close=function(e){i.removeClass("is-active");var n=t("#beat-modal-"+e);n.hide(),n.remove()},e.prototype.launchModal=function(i,n){var o=n||e.Static.currentBeatIndex;t("#beat-modal-"+o).length||e.Modal.createIframe(i,o),e.Modal.show(o)},n.click(function(t){e.Modal.close(e.Static.getCurrentBeatNum())})}(jQuery,StoryGist),function(t,e){e.prototype.beatVideoPlay=function(t){t&&t.play()},e.prototype.beatVideoPause=function(t){t&&t.pause()},e.prototype.beatVideoPauseAll=function(e){var i=this;t("video").each(function(t,e){i.beatVideoPause(e)})},e.prototype.goToBeginning=function(){t(".gist-beat").css("display","flex")},e.prototype.pauseBeats=function(){this.beatVideoPauseAll()},e.prototype.nextBeat=function(i,n){if(console.log(">> Next",i),this.pauseBeats(),t(n).hasClass("last"));else{var o=t(n).next(".gist-beat");if(window.SplitType&&o.find(".js-text-block").length&&this.settings.animate){console.log("Animate Textblock");var a=new SplitType(".js-text-block");a.split({split:"lines",position:"relative"}),t.Velocity(a.lines,e.Static.TRANSITIONS[3],{duration:450,stagger:37.5})}if(this.settings.animate&&(o.find("figure img").velocity({blur:0},{duration:750,begin:function(e){o.find("figure figcaption").css("opacity",0),t(e).css("-webkit-filter","blur(81px)")},complete:function(t){o.find("figure figcaption").velocity("transition.slideLeftIn",{duration:1312.5})}}),o.find("figure.media").velocity({blur:0},{duration:750,begin:function(e){t(e).css("-webkit-filter","blur(81px)")}}),window.SplitType&&o.find(".pullquote").length)){console.log("Animate PULLQUOTE");var s=new SplitType(o.find(".pullquote"),{split:"lines"});t.Velocity(s.lines,e.Static.getRandTransition(),{duration:750,stagger:375})}var r=o.find("video").get(0);this.beatVideoPlay(r)}e.Navigation.navigateToBeat(+i+1,+this.totalBeats)},e.prototype.prevBeat=function(i,n){if(console.log(">> Prev",i),this.pauseBeats(),t(n).is("#gist-beat-0"));else{var o=t(n).prev(".gist-beat").find("video").get(0);this.beatVideoPlay(o)}e.Navigation.navigateToBeat(+i-1)},e.prototype.viewInStory=function(){var i=e.Static.getCurrentBeat(),n=t(i).data("origid"),o=t(i).data("cta-url");if(this.pauseBeats(),o)this.launchModal(o,n);else{t("#gist-body").css("display","none"),t(this.element).toggleClass("gist-active"),t(this.settings.contentParent).css("display","block"),t(".site-header").css("display","block"),t(".progress").css("display","block");var a=t(this.settings.contentParent+" "+this.settings.beatSelector+":eq("+n+")");t("html, body").animate({scrollTop:a.offset().top-80},2e3)}},e.prototype.swipeBeat=function(t){var i=e.Static.getCurrentBeat(),n=i.attr("id").split("-")[2];switch(t.direction){case 8:this.viewInStory();break;case 2:this.nextBeat(n,i);break;case 4:this.prevBeat(n,i);break;default:console.log(t.type,t.direction)}},e.prototype.clickBeat=function(i){var n=e.Static.getCurrentBeat(),o=n.data("origid"),a=n.width(),s=n.position().left,r=i.pageX-s;console.log("click target el",t(i.target)[0].tagName),"INPUT"!==t(i.target)[0].tagName&&"BUTTON"!==t(i.target)[0].tagName&&(r>a/2.5?this.nextBeat(o,n):this.prevBeat(o,n))},e.prototype.scrollLock=function(t){t.preventDefault()},e.prototype.onOrientationChange=function(){var e=90===Math.abs(window.orientation)?"landscape":"portrait",i=t("body");"portrait"===e&&i.addClass("gist-portrait").removeClass("gist-landscape"),"landscape"===e&&i.addClass("gist-landscape").removeClass("gist-portrait")}}(jQuery,StoryGist),function(t,e){e.prototype.init=function(){var i=this;e.Static.dependencyChecker(["jQuery","Hammer","Navigo","SplitType","videojs","$.Velocity","lazySizes"]);var n=t(i.element);if(t(window).width()<=i.settings.initWidth){var o=[],a=t(i.settings.contentParent),s=t(i.settings.beatSelector);if(n.prepend('<div id="gist-body"></div>'),!0===i.settings.onboard){var r=t('<div class="gist-onboard-container"><p>You\'re viewing the <strong>Gist</strong> of this story. The Gist gives you a visual summary of the story.</p><div class="gist-onboard-ui-container"><div class="gist-onboard-ui-left"><div class="gist-onboard-ui-text"> <p>← <strong>Tap</strong> to go <strong>backward</strong> in Gist</p></div></div><div class="gist-onboard-ui-right"><div class="gist-onboard-ui-text"><p><strong>Tap</strong> to go <br /> <strong>forward</strong> in Gist →</div></div></div><div class="gist-onboard-ui-text gist-onboard-ui-text-cta animated infinite bounce">Scroll to enter Gist <br />↓</p></div></div>');n.prepend(r)}var l=t("#gist-body");a.css("display","none"),n.addClass("gist-active"),s.each(function(e,i){var n={raw:i,html:i.outerHTML,type:i.nodeName,id:e,ctaUrl:"",ctaText:"View Story"};t(i).data("cta-url")&&(n.ctaUrl=t(i).data("cta-url")),t(i).data("cta-text")&&(n.ctaText=t(i).data("cta-text")),null!=i.previousElementSibling&&(n.prevtype=i.previousElementSibling.nodeName),"p"===n.type.toLowerCase()&&void 0!==n.prevtype?"h2"!==n.prevtype.toLowerCase()&&"figure"!==n.prevtype.toLowerCase()||o.push(n):o.push(n)}),o.push(i.settings.finalBeat),l.append('<button id="gist-view-story">'+i.settings.callToAction+"</button>"),t("#gist-view-story").click(function(){window.removeEventListener("touchmove",i.scrollLock),i.viewInStory()}),i.totalBeats=+(o.length-1),l.append('<div id="gist-progress"></div>');var c=t(i.settings.pager.html);c.find(".gist-pager__btn--next").on("click",function(){var t=e.Static.getCurrentBeat(),n=e.Static.getCurrentBeatNum();i.nextBeat(n,t)}),c.find(".gist-pager__btn--prev").on("click",function(){var t=e.Static.getCurrentBeat(),n=e.Static.getCurrentBeatNum();i.prevBeat(n,t)}),l.append(c),o.forEach(function(e,n){!0===e.onBoard?l.append('<div id="gist-beat-'+n+'" class="gist-beat gist-beat-onboard" style="z-index:'+(i.totalBeats-n)+';">'+e.html+"</div>"):l.append('<div id="gist-beat-'+n+'" class="gist-beat" data-cta-url="'+e.ctaUrl+'" data-cta-text="'+e.ctaText+'" data-origid="'+n+'"  style="z-index:'+(i.totalBeats-n)+';">'+e.html+"</div>"),+n!=+i.totalBeats&&t("#gist-progress").append('<div id="gist-progress-beat-'+n+'" class="gist-progress-beat inactive" style="flex: 1;"></div>')});var d=t("#gist-beat-0");t(".go-to-beginning").click(function(){t("#gist-progress").css("display","flex"),t(".gist-progress-beat").removeClass("inactive"),t(".gist-progress-beat").css("opacity",1),t(".gist-beat.last").removeClass("active"),d.addClass("active"),i.goToBeginning()}),d.addClass("active"),t(".gist-beat").click(i.clickBeat.bind(i)),t(".gist-beat:last-of-type").addClass("last"),t(".gist-beat").each(function(e){var i=t(this).find("video"),n=t(this).find(".video-js"),o=t(i).attr("id"),a=t(n).attr("id");void 0!==o&&t(i).attr("id",o+"-gist-beat"),void 0!==a&&t(n).attr("id",a+"-gist-beat")}),window.addEventListener("scroll",function t(){window.pageYOffset>=l.offset().top&&(r&&r.remove(),window.removeEventListener("scroll",t),window.addEventListener("touchmove",i.scrollLock))}),i.onOrientationChange(),window.addEventListener("orientationchange",function(){i.onOrientationChange()}),i.initHammer(),i.initNavigation()}},e.prototype.initHammer=function(){var e=this;"function"==typeof window.Hammer&&t(".gist-beat").each(function(t,i){var n=new Hammer(i);n.on("swipe",e.swipeBeat.bind(e)),n.get("swipe").set({direction:Hammer.DIRECTION_ALL})})}}(jQuery,StoryGist),function(t){t.fn.storyGist=function(e){return this.each(function(){if(void 0===t(this).data("storyGist")){new StoryGist(this,e).init()}})}}(jQuery);